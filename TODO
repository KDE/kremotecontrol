Code overhaul.
More advanced features implementing.

